{% extends "admin_custom/base_admin.html" %}
{% block title %}Cotações do Milheiro{% endblock %}
{% block header_title %}Cotações do Milheiro{% endblock %}
{% block menu_cotacoes %}bg-zinc-700 text-white{% endblock %}
{% block content %}
<h2>Atualizar cotação do milheiro</h2>
<form method="post" class="flex flex-wrap gap-3 items-end mb-6">
    {% csrf_token %}
    <select name="programa_nome" required>
        <option value="">-- Programa --</option>
        {% for p in programas %}
        <option value="{{ p.nome }}">{{ p.nome }}</option>
        {% endfor %}
    </select>
    <input type="number" step="0.01" min="0" name="valor_mercado" placeholder="Valor mercado" required class="w-36" />
    <button type="submit">Salvar</button>
</form>

<form method="get" class="flex gap-3 mb-6">
    <input type="text" name="busca" value="{{ busca }}" placeholder="Buscar programa..." />
    <button type="submit">Buscar</button>
</form>

<div class="overflow-x-auto">
    <table>
        <thead>
            <tr>
                <th>Programa</th>
                <th>Cotação Mercado</th>
                <th>Última atualização</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for cot in cotacoes %}
            <tr>
                <td>{{ cot.programa_nome }}</td>
                <td>R$ {{ cot.valor_mercado|floatformat:2 }}</td>
                <td>{{ cot.atualizado_em|date:"d/m/Y" }}</td>
                <td><a href="{% url 'admin_deletar_cotacao' cot.id %}">Deletar</a></td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">Nenhuma cotação cadastrada.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
