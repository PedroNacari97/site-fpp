{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <title>{% block title %}Administra√ß√£o{% endblock %} - Gest√£o de Pontos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="{% static 'gestao/admin_custom.css' %}">
    <link rel="stylesheet" href="{% static 'gestao/css/main.css' %}">
    <link rel="stylesheet" href="{% static 'gestao/formulario_base_gestao.css' %}">
    <link rel="stylesheet" href="{% static 'painel_cliente/css/layout/layout.css' %}">

    {% block extra_head %}{% endblock %}
</head>

<body>
<div class="app-shell">
    <div class="sidebar-overlay" data-sidebar-overlay></div>

    <aside class="sidebar" data-sidebar>
        <div class="sidebar-header">
            <h1 class="sidebar-title">NCfly</h1>
            <button class="icon-button sidebar-close" type="button" aria-label="Fechar menu" data-sidebar-close>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M6 6l12 12M18 6l-12 12" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                </svg>
            </button>
        </div>
        <nav class="sidebar-nav">
            {% if request.user.is_superuser %}
                <a class="nav-item {% block menu_empresas %}{% endblock %}" href="{% url 'admin_empresas' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 10h18v11H3z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M7 10V3h10v7" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Empresas</span>
                </a>
            {% else %}
                <a class="nav-item {% block menu_dashboard %}{% endblock %}" href="{% url 'admin_dashboard' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 12 12 3l9 9" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M9 21V9h6v12" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Dashboard</span>
                </a>

                <a class="nav-item {% block menu_clientes %}{% endblock %}" href="{% url 'admin_clientes' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <circle cx="8.5" cy="7" r="4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M20 8v6M23 11h-6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Clientes</span>
                </a>

                <a class="nav-item {% block menu_contas %}{% endblock %}" href="{% url 'admin_contas' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M4 4h16v16H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M8 2v4M16 2v4M4 10h16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Contas Fidelidade</span>
                </a>

                <a class="nav-item {% block menu_contas_adm %}{% endblock %}" href="{% url 'admin_contas_administradas' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 7h18" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M3 12h18" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M3 17h18" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Contas Administradas</span>
                </a>

                <a class="nav-item {% block menu_cotacoes_voo %}{% endblock %}" href="{% url 'admin_cotacoes_voo' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M2 12h20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M5 12l6-6M5 12l6 6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Cota√ß√µes</span>
                </a>

                <a class="nav-item {% block menu_emissoes %}{% endblock %}" href="{% url 'admin_emissoes' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M4 4h16v16H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M7 7h10M7 11h10M7 15h6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Emiss√µes</span>
                </a>

                <a class="nav-item {% block menu_hoteis %}{% endblock %}" href="{% url 'admin_hoteis' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 20h18" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M4 20V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v13" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M8 14h.01M12 14h.01M16 14h.01" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Hot√©is</span>
                </a>

                <a class="nav-item {% block menu_calculadora %}{% endblock %}" href="{% url 'admin_calculadora_cotacao' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M6 4h12v16H6z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M8 8h8M8 12h2M14 12h2M8 16h2M14 16h2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Calculadora</span>
                </a>

                <a class="nav-item {% block menu_emissores_parceiros %}{% endblock %}" href="{% url 'admin_emissores_parceiros' %}">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M4 4h16v6H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M4 14h10v6H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        <path d="M18 14v6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                    <span>Emissores Parceiros</span>
                </a>

                <details class="nav-group" {% block dados_complementares_open %}{% endblock %}>
                    <summary class="nav-item nav-item--summary">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M4 4h16v16H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            <path d="M8 12h8M12 8v8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        </svg>
                        <span>Dados Complementares</span>
                    </summary>
                    <div class="nav-subitems">
                        <a class="nav-item {% block menu_aeroportos %}{% endblock %}" href="{% url 'admin_aeroportos' %}">
                            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M2 12h20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                <path d="M6 16l6-6 6 6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            </svg>
                            <span>Aeroporto</span>
                        </a>
                        <a class="nav-item {% block menu_companhias %}{% endblock %}" href="{% url 'admin_companhias' %}">
                            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M2 8l10 4 10-4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                <path d="M2 12l10 4 10-4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            </svg>
                            <span>Companhia A√©rea</span>
                        </a>
                        <a class="nav-item {% block menu_programas %}{% endblock %}" href="{% url 'admin_programas' %}">
                            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M4 4h16v6H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                <path d="M4 14h16v6H4z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            </svg>
                            <span>Programa de Pontos</span>
                        </a>
                    </div>
                </details>
            {% endif %}

            {% if not request.user.is_superuser %}
            <a class="nav-item {% block menu_auditoria %}{% endblock %}" href="{% url 'admin_auditoria' %}">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 6v6l4 2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                </svg>
                <span>Auditoria</span>
            </a>
            {% endif %}

            {% with perfil=request.user.cliente_gestao.perfil %}
                {% if perfil == "admin" or request.user.is_superuser %}
                    <a class="nav-item" href="{% url 'user_list' %}">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            <circle cx="8.5" cy="7" r="4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        </svg>
                        <span>Usu√°rios Administradores</span>
                    </a>
                    <a class="nav-item {% block menu_operadores %}{% endblock %}" href="{% url 'operator_list' %}">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 6v6l4 2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                            <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                        </svg>
                        <span>Operadores</span>
                    </a>
                {% endif %}
            {% endwith %}

            <a class="nav-item" href="{% url 'logout' %}">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    <path d="M10 17l5-5-5-5" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    <path d="M15 12H3" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                </svg>
                <span>Sair</span>
            </a>
        </nav>
    </aside>

    <div class="app-shell__content">
        <header class="app-header">
            <div class="app-header__left">
                <button class="icon-button menu-button" type="button" aria-label="Abrir menu" data-sidebar-open>
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M4 6h16M4 12h16M4 18h16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                    </svg>
                </button>
                <h2 class="app-header__title">{% block page_title %}Gest√£o Admin{% endblock %}</h2>
            </div>
            <div class="app-header__actions">
                <span class="user-name">{{ request.user.get_full_name|default:request.user.username }}</span>
                <button class="icon-button" type="button" data-theme-toggle aria-label="Alternar modo escuro">üåô</button>
                <form action="{% url 'logout' %}" method="post">{% csrf_token %}
                    <button class="btn btn--outline btn--sm" type="submit">Logout</button>
                </form>
            </div>
        </header>

        <main class="app-main fpp-main">
            <div class="fpp-container">
                <div class="page-shell">
                    <div class="page-header fpp-header">
                        <div class="page-header__titles">
                            <h1 class="page-title">{% block header_title %}Painel Administrativo{% endblock %}</h1>
                            {% block header_subtitle %}{% endblock %}
                        </div>
                        <div class="page-actions fpp-actions">
                            {% block header_actions %}{% endblock %}
                        </div>
                    </div>

                    {% if messages %}
                    <div class="message-stack">
                        {% for message in messages %}
                        <div class="alert {% if 'success' in message.tags %}alert-success{% else %}alert-danger{% endif %}">
                            {{ message }}
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}

                    {% block content %}{% endblock %}
                </div>
            </div>
        </main>
    </div>
</div>

{% block extra_body %}{% endblock %}

<script src="{% static 'gestao/js/forms.js' %}" defer></script>
<script type="module" src="{% static 'painel_cliente/js/app.js' %}" defer></script>

</body>
</html>
