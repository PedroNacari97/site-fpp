<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel do Cliente</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { background: #181828; color: #f6f6f6; font-family: 'Segoe UI', Arial, sans-serif; min-height: 100vh; margin: 0;}
        .header { background: #232345; padding: 24px; text-align: center; }
        .header h1 { color: #b67cff; margin: 0; }
        .logout { float: right; background: #2d195d; color: #f6f6f6; border-radius: 8px; padding: 7px 17px; text-decoration: none; margin: 10px;}
        .painel { max-width: 900px; margin: 38px auto 0 auto; padding: 40px 24px; background: #232345; border-radius: 22px; box-shadow: 0 2px 32px rgba(0,0,0,.55);}
        .card-grid { display: flex; gap: 23px; flex-wrap: wrap; margin-bottom: 28px;}
        .card { background: #28284c; border-radius: 16px; padding: 22px 28px; flex: 1 1 170px; min-width: 200px; text-align: center;}
        .card h3 { color: #a78bfa; margin: 0 0 7px 0; font-size: 1.05rem;}
        .card span { font-size: 1.6rem; font-weight: 700;}
        .section-title {color: #b67cff; margin-top: 18px;}
        .tablebox {background: #23234a; border-radius: 14px; margin: 28px 0 0 0; padding: 22px;}
        table { width: 100%; border-collapse: collapse; margin-top: 12px;}
        th, td {padding: 10px 7px; border-bottom: 1px solid #353581;}
        th {color: #d1c1f7; text-align: left;}
        td {color: #e3d8fa;}
        .btn { background: #b67cff; color: #222; border-radius: 9px; padding: 7px 18px; text-decoration: none; font-weight: 600;}
        .painel-footer {margin: 28px 0 0 0; text-align: center; font-size: .96rem; color: #8f8fc5;}
    </style>
</head>
<body>
    <div class="header">
        <a href="{% url 'logout' %}" class="logout">Logout</a>
        <h1>Bem-vindo, {{ request.user.get_full_name|default:request.user.username }}</h1>
        <div>Resumo da sua gestão de pontos</div>
    </div>
    <div class="painel">

        <div class="card-grid">
            <div class="card">
                <h3>Saldo de Pontos</h3>
                <span>{{ saldo_pontos }}</span>
            </div>
            <div class="card">
                <h3>Valor total pago</h3>
                <span>R$ {{ valor_total_pago|floatformat:2 }}</span>
            </div>
            <div class="card">
                <h3>Valor médio / mil</h3>
                <span>R$ {{ valor_medio|floatformat:2 }}</span>
            </div>
            <div class="card">
                <h3>Pontos usados</h3>
                <span>{{ pontos_totais_utilizados }}</span>
            </div>
            <div class="card">
                <h3>Valor referência</h3>
                <span>R$ {{ valor_total_referencia|floatformat:2 }}</span>
            </div>
        </div>

        <div class="card-grid" style="margin-bottom:0">
            <div class="card">
                <h3>Qtd. emissões</h3>
                <span>{{ qtd_emissoes }}</span>
            </div>
            <div class="card">
                <h3>Gasto (dinheiro)</h3>
                <span>R$ {{ valor_total_gasto|floatformat:2 }}</span>
            </div>
            <div class="card">
                <h3>Economizado</h3>
                <span>R$ {{ valor_total_economizado|floatformat:2 }}</span>
            </div>
        </div>

        <div style="text-align:center; margin: 38px 0 20px;">
            <a href="{% url 'painel_emissoes' %}" class="btn">Ver Emissões Detalhadas</a>
            <a href="{% url 'painel_movimentacoes' %}" class="btn">Movimentações</a>
        </div>

        <div class="painel-footer">
            <strong>Cotação do milheiro mercado:</strong>  
            {% for cotacao in cotacoes_mercado %}
                {{ cotacao.programa_nome }}: R$ {{ cotacao.valor_mercado|floatformat:2 }}{% if not forloop.last %} | {% endif %}
            {% empty %}
                (Sem cotação cadastrada ainda)
            {% endfor %}
        </div>
    </div>
</body>
</html>
