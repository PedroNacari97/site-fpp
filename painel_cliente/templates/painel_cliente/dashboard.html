{% extends 'painel_cliente/base_painel.html' %}

{% block title %}Painel do Cliente{% endblock %}

{% block content %}
    <div class="painel-header">
        <h1>Bem-vindo, {{ request.user.first_name|default:request.user.username }}!</h1>
        <form action="{% url 'logout' %}" method="post">{% csrf_token %}
            <button type="submit">Logout</button>
        </form>
    </div>

    <h2 class="section-title">Programas de Fidelidade</h2>
    <div class="painel-cards">
        {% for c in contas_info %}
        <div class="card">
            <strong>{{ c.programa }}</strong>
            <span class="label">Pontos acumulados</span>
            <span class="valor">{{ c.saldo_pontos }}</span>
            <span class="label">Valor total dos pontos</span>
            <span class="valor">R$ {{ c.valor_total|floatformat:2 }}</span>
            <span class="label">Valor médio por 1.000 pontos</span>
            <span class="valor">R$ {{ c.valor_medio|floatformat:2 }}</span>
            <span class="label">Valor de referência</span>
            <span class="valor">R$ {{ c.valor_referencia|floatformat:2 }}</span>
            <a href="{% url 'movimentacoes_programa' c.id %}">Ver movimentações</a>
        </div>
        {% empty %}
        <p>Nenhum programa cadastrado.</p>
        {% endfor %}
    </div>

    <h2 class="section-title">Emissões e Hotéis</h2>
    <div class="painel-cards">
        <div class="card">
            <strong>Emissões</strong>
            <span class="label">Quantidade total de emissões</span>
            <span class="valor">{{ qtd_emissoes }}</span>
            <span class="label">Valor total gasto em pontos</span>
            <span class="valor">{{ pontos_totais_utilizados }}</span>
            <span class="label">Valor de referência acumulado</span>
            <span class="valor">R$ {{ valor_total_referencia|floatformat:2 }}</span>
            <span class="label">Valor total pago</span>
            <span class="valor">R$ {{ valor_total_pago|floatformat:2 }}</span>
            <span class="label">Valor total economizado</span>
            <span class="valor">R$ {{ valor_total_economizado|floatformat:2 }}</span>
            <a href="{% url 'painel_emissoes' %}">Ver detalhes</a>
        </div>

        <div class="card">
            <strong>Hotéis</strong>
            <span class="label">Quantidade de reservas de hotéis</span>
            <span class="valor">{{ qtd_hoteis }}</span>
            <span class="label">Valor de referência acumulado</span>
            <span class="valor">R$ {{ valor_total_hoteis_referencia|floatformat:2 }}</span>
            <span class="label">Valor total pago</span>
            <span class="valor">R$ {{ valor_total_hoteis|floatformat:2 }}</span>
            <span class="label">Valor total economizado</span>
            <span class="valor">R$ {{ valor_total_hoteis_economia|floatformat:2 }}</span>
            <a href="{% url 'painel_hoteis' %}">Ver detalhes</a>
        </div>
    </div>
{% endblock %}
